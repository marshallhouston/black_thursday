<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Black thursday</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.10.2/application.js' type='text/javascript'></script>    
    <link href='./assets/0.10.2/application.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="./assets/0.10.2/favicon_yellow.png" />
    <link rel="icon" type="image/png" href="./assets/0.10.2/favicon.png" />
  </head>
  
  <body>
    <div id="loading">
      <img src="./assets/0.10.2/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2017-09-18T20:15:33-06:00">2017-09-18T20:15:33-06:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="yellow">87.27%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         507.42
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>16</b> files in total.
    <b>495</b> relevant lines. 
    <span class="green"><b>432</b> lines covered</span> and
    <span class="red"><b>63</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#f99ea017de416b1ec48d9f48ae7092a7ed977862" class="src_link" title="lib/csv_parser.rb">lib/csv_parser.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>9</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>147.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e88aef84ee197ab74e91620a406d9d71b06de83f" class="src_link" title="lib/customer.rb">lib/customer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>32</td>
        <td>17</td>
        <td>17</td>
        <td>0</td>
        <td>796.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8a1d19b8837bd3333631c7416c6dcbbfa33807ba" class="src_link" title="lib/customer_repository.rb">lib/customer_repository.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>49</td>
        <td>28</td>
        <td>28</td>
        <td>0</td>
        <td>106.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#28ce4ac4dea3319a2745ae83287434301cb205ec" class="src_link" title="lib/invoice.rb">lib/invoice.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>89</td>
        <td>44</td>
        <td>44</td>
        <td>0</td>
        <td>800.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e025f6794d2e2de8fb92eed16e6ab7425fe6e563" class="src_link" title="lib/invoice_item.rb">lib/invoice_item.rb</a></td>
        <td class="yellow strong">88.24 %</td>
        <td>32</td>
        <td>17</td>
        <td>15</td>
        <td>2</td>
        <td>2610.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#682e096b93f71960c3adbdb04b1a53de71f2f0c4" class="src_link" title="lib/invoice_item_repository.rb">lib/invoice_item_repository.rb</a></td>
        <td class="green strong">91.67 %</td>
        <td>42</td>
        <td>24</td>
        <td>22</td>
        <td>2</td>
        <td>327.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7daf7565a0e67cc7e5515a1c6defc32799450be9" class="src_link" title="lib/invoice_repository.rb">lib/invoice_repository.rb</a></td>
        <td class="green strong">94.12 %</td>
        <td>63</td>
        <td>34</td>
        <td>32</td>
        <td>2</td>
        <td>253.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#cdd5b2272d9aa7afbd7cf7f48e2f4e341d0e9de1" class="src_link" title="lib/item.rb">lib/item.rb</a></td>
        <td class="green strong">94.74 %</td>
        <td>35</td>
        <td>19</td>
        <td>18</td>
        <td>1</td>
        <td>3155.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bcb176bc07ec6eccd0262755a8d1ff2c748b2567" class="src_link" title="lib/item_repository.rb">lib/item_repository.rb</a></td>
        <td class="green strong">90.91 %</td>
        <td>58</td>
        <td>33</td>
        <td>30</td>
        <td>3</td>
        <td>972.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d10b1dc3bea25c54c9fac429310f93871ddc48f6" class="src_link" title="lib/merchant.rb">lib/merchant.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>28</td>
        <td>15</td>
        <td>15</td>
        <td>0</td>
        <td>499.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#62de711d7be3b66ca28271b511d229868323639f" class="src_link" title="lib/merchant_repository.rb">lib/merchant_repository.rb</a></td>
        <td class="green strong">96.55 %</td>
        <td>52</td>
        <td>29</td>
        <td>28</td>
        <td>1</td>
        <td>140.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0460387b0aa911a69af3639f0f415f27b8d93d1e" class="src_link" title="lib/sales_analyst.rb">lib/sales_analyst.rb</a></td>
        <td class="red strong">71.29 %</td>
        <td>193</td>
        <td>101</td>
        <td>72</td>
        <td>29</td>
        <td>11.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#48800ae1d9a8fa7f94544f741aa82863097794b4" class="src_link" title="lib/sales_engine.rb">lib/sales_engine.rb</a></td>
        <td class="green strong">95.08 %</td>
        <td>113</td>
        <td>61</td>
        <td>58</td>
        <td>3</td>
        <td>85.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a1a99ffea6a5ab4aa02b88a1d79da61ec67c1c9a" class="src_link" title="lib/standard_deviation.rb">lib/standard_deviation.rb</a></td>
        <td class="red strong">58.06 %</td>
        <td>57</td>
        <td>31</td>
        <td>18</td>
        <td>13</td>
        <td>12.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#81a6f197880d7cda8d4e903a3a38bdf7757aece4" class="src_link" title="lib/transaction.rb">lib/transaction.rb</a></td>
        <td class="green strong">92.86 %</td>
        <td>27</td>
        <td>14</td>
        <td>13</td>
        <td>1</td>
        <td>1440.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c0923319536369ccb0e1948014f6d2aca0887619" class="src_link" title="lib/transaction_repository.rb">lib/transaction_repository.rb</a></td>
        <td class="red strong">75.0 %</td>
        <td>42</td>
        <td>24</td>
        <td>18</td>
        <td>6</td>
        <td>310.7</td>
      </tr>
      
    </tbody>
  </table>
</div>


        
      </div>
    
      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.15.1 
        and simplecov-html v0.10.2<br/>
        using MiniTest
      </div>
    
      <div class="source_files">
      
        <div class="source_table" id="f99ea017de416b1ec48d9f48ae7092a7ed977862">
  <div class="header">
    <h3>lib/csv_parser.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;csv&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">module CsvParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_data(file_name)</code>
        </li>
      
        <li class="covered" data-hits="588" data-linenumber="6">
          <span class="hits">588</span>
          
          <code class="ruby">    CSV.open file_name, headers: true, header_converters: :symbol</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="e88aef84ee197ab74e91620a406d9d71b06de83f">
  <div class="header">
    <h3>lib/customer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines. 
      <span class="green"><b>17</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;time&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class Customer</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">              :first_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">              :last_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">              :created_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">              :updated_at</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(info, customer_repository=&#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="2256" data-linenumber="11">
          <span class="hits">2256</span>
          
          <code class="ruby">    @id = info[:id].to_i</code>
        </li>
      
        <li class="covered" data-hits="2256" data-linenumber="12">
          <span class="hits">2256</span>
          
          <code class="ruby">    @first_name = info[:first_name]</code>
        </li>
      
        <li class="covered" data-hits="2256" data-linenumber="13">
          <span class="hits">2256</span>
          
          <code class="ruby">    @last_name = info[:last_name]</code>
        </li>
      
        <li class="covered" data-hits="2256" data-linenumber="14">
          <span class="hits">2256</span>
          
          <code class="ruby">    @created_at = Time.parse(info[:created_at])</code>
        </li>
      
        <li class="covered" data-hits="2256" data-linenumber="15">
          <span class="hits">2256</span>
          
          <code class="ruby">    @updated_at = Time.parse(info[:updated_at])</code>
        </li>
      
        <li class="covered" data-hits="2256" data-linenumber="16">
          <span class="hits">2256</span>
          
          <code class="ruby">    @customer_repository = customer_repository</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoices</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">    @customer_repository.find_invoices_by_customer_id(@id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def merchants</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    merchants = []</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    invoices.each do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">      merchants &lt;&lt; @customer_repository.find_merchants(invoice.merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    merchants</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="8a1d19b8837bd3333631c7416c6dcbbfa33807ba">
  <div class="header">
    <h3>lib/customer_repository.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>28</b> relevant lines. 
      <span class="green"><b>28</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;csv_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;customer&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class CustomerRepository</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  include CsvParser</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :sales_engine</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :customers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(file_name, sales_engine)</code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="10">
          <span class="hits">94</span>
          
          <code class="ruby">    @customers = []</code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="11">
          <span class="hits">94</span>
          
          <code class="ruby">    item_contents = parse_data(file_name)</code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="12">
          <span class="hits">94</span>
          
          <code class="ruby">    item_contents.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="2256" data-linenumber="13">
          <span class="hits">2256</span>
          
          <code class="ruby">      @customers &lt;&lt; Customer.new(row, self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="15">
          <span class="hits">94</span>
          
          <code class="ruby">    @sales_engine = sales_engine</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def all</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="19">
          <span class="hits">6</span>
          
          <code class="ruby">    @customers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_id(id)</code>
        </li>
      
        <li class="covered" data-hits="162" data-linenumber="23">
          <span class="hits">162</span>
          
          <code class="ruby">    @customers.find {|customer| customer.id == id}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_first_name(first_name)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="27">
          <span class="hits">3</span>
          
          <code class="ruby">    @customers.select do |customer|</code>
        </li>
      
        <li class="covered" data-hits="72" data-linenumber="28">
          <span class="hits">72</span>
          
          <code class="ruby">      customer.first_name.downcase.include?(first_name.downcase)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_last_name(last_name)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="33">
          <span class="hits">3</span>
          
          <code class="ruby">    @customers.select do |customer|</code>
        </li>
      
        <li class="covered" data-hits="72" data-linenumber="34">
          <span class="hits">72</span>
          
          <code class="ruby">      customer.last_name.downcase.include?(last_name.downcase)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_invoices_by_customer_id(customer_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">    @sales_engine.invoices.find_all_by_customer_id(customer_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_merchants(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    @sales_engine.merchants.find_by_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  def inspect</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">    &quot;#&lt;#{self.class} #{@merchants.size} rows&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="28ce4ac4dea3319a2745ae83287434301cb205ec">
  <div class="header">
    <h3>lib/invoice.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>44</b> relevant lines. 
      <span class="green"><b>44</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;time&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;date&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;bigdecimal&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">class Invoice</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">              :customer_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">              :merchant_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">              :status,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">              :created_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">              :updated_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">              :date</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(invoice_data, invoice_repository)</code>
        </li>
      
        <li class="covered" data-hits="4326" data-linenumber="16">
          <span class="hits">4326</span>
          
          <code class="ruby">      @id = invoice_data[:id].to_i</code>
        </li>
      
        <li class="covered" data-hits="4326" data-linenumber="17">
          <span class="hits">4326</span>
          
          <code class="ruby">      @customer_id = invoice_data[:customer_id].to_i</code>
        </li>
      
        <li class="covered" data-hits="4326" data-linenumber="18">
          <span class="hits">4326</span>
          
          <code class="ruby">      @merchant_id = invoice_data[:merchant_id].to_i</code>
        </li>
      
        <li class="covered" data-hits="4326" data-linenumber="19">
          <span class="hits">4326</span>
          
          <code class="ruby">      @status = invoice_data[:status].to_sym</code>
        </li>
      
        <li class="covered" data-hits="4326" data-linenumber="20">
          <span class="hits">4326</span>
          
          <code class="ruby">      @created_at = Time.parse(invoice_data[:created_at])</code>
        </li>
      
        <li class="covered" data-hits="4326" data-linenumber="21">
          <span class="hits">4326</span>
          
          <code class="ruby">      @updated_at = Time.parse(invoice_data[:updated_at])</code>
        </li>
      
        <li class="covered" data-hits="4326" data-linenumber="22">
          <span class="hits">4326</span>
          
          <code class="ruby">      @invoice_repository = invoice_repository</code>
        </li>
      
        <li class="covered" data-hits="4326" data-linenumber="23">
          <span class="hits">4326</span>
          
          <code class="ruby">      @date = Time.new(invoice_data[:created_at]).strftime(&#39;%A&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def merchant</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">      @invoice_repository.sales_engine.merchants.find_by_id(@merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def day_of_the_week</code>
        </li>
      
        <li class="covered" data-hits="140" data-linenumber="31">
          <span class="hits">140</span>
          
          <code class="ruby">    case date</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    when &#39;Sunday&#39;</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="33">
          <span class="hits">12</span>
          
          <code class="ruby">      &#39;Saturday&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    when &#39;Monday&#39;</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="35">
          <span class="hits">15</span>
          
          <code class="ruby">      &#39;Sunday&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    when &#39;Tuesday&#39;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="37">
          <span class="hits">6</span>
          
          <code class="ruby">      &#39;Monday&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    when &#39;Wednesday&#39;</code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="39">
          <span class="hits">33</span>
          
          <code class="ruby">      &#39;Tuesday&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    when &#39;Thursday&#39;</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="41">
          <span class="hits">27</span>
          
          <code class="ruby">      &#39;Wednesday&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    when &#39;Friday&#39;</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="43">
          <span class="hits">22</span>
          
          <code class="ruby">      &#39;Thursday&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    when &#39;Saturday&#39;</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="45">
          <span class="hits">25</span>
          
          <code class="ruby">      &#39;Friday&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  def items</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    # invoice_items = @invoice_repository.find_all_invoice_items_by_invoice_id(@id)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="51">
          <span class="hits">3</span>
          
          <code class="ruby">    invoice_items.map do |invoice_item|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="52">
          <span class="hits">3</span>
          
          <code class="ruby">      @invoice_repository.find_item_by_item_id(invoice_item.item_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">  def transactions</code>
        </li>
      
        <li class="covered" data-hits="148" data-linenumber="57">
          <span class="hits">148</span>
          
          <code class="ruby">    @invoice_repository.find_all_transactions_by_invoice_id(@id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">  def customer</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="61">
          <span class="hits">2</span>
          
          <code class="ruby">    @invoice_repository.find_customer_by_id(@customer_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoice_items</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="65">
          <span class="hits">30</span>
          
          <code class="ruby">    @invoice_repository.find_all_invoice_items_by_invoice_id(@id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">  def is_paid_in_full?</code>
        </li>
      
        <li class="covered" data-hits="54" data-linenumber="71">
          <span class="hits">54</span>
          
          <code class="ruby">    return false if transactions.count == 0</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="72">
          <span class="hits">30</span>
          
          <code class="ruby">    transactions.all? do |transaction|</code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="73">
          <span class="hits">33</span>
          
          <code class="ruby">      transaction.result == &#39;success&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">  def partially_paid_transactions</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">    transactions.select do |transaction|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="79">
          <span class="hits">3</span>
          
          <code class="ruby">      transaction.result == &#39;success&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="83">
          <span class="hits">1</span>
          
          <code class="ruby">  def total</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="84">
          <span class="hits">25</span>
          
          <code class="ruby">    invoice_items.reduce(BigDecimal.new(0, 4)) do |invoice_total ,invoice_item|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="85">
          <span class="hits">3</span>
          
          <code class="ruby">      (invoice_item.unit_price * invoice_item.quantity) + invoice_total</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="e025f6794d2e2de8fb92eed16e6ab7425fe6e563">
  <div class="header">
    <h3>lib/invoice_item.rb</h3>
    <h4><span class="yellow">88.24 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines. 
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;bigdecimal&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;time&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class InvoiceItem</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">              :item_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">              :invoice_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">              :quantity,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">              :unit_price,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">              :created_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">              :updated_at</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(info, invoice_item_repository)</code>
        </li>
      
        <li class="covered" data-hits="5546" data-linenumber="15">
          <span class="hits">5546</span>
          
          <code class="ruby">    @id = info[:id].to_i</code>
        </li>
      
        <li class="covered" data-hits="5546" data-linenumber="16">
          <span class="hits">5546</span>
          
          <code class="ruby">    @item_id = info[:item_id].to_i</code>
        </li>
      
        <li class="covered" data-hits="5546" data-linenumber="17">
          <span class="hits">5546</span>
          
          <code class="ruby">    @invoice_id = info[:invoice_id].to_i</code>
        </li>
      
        <li class="covered" data-hits="5546" data-linenumber="18">
          <span class="hits">5546</span>
          
          <code class="ruby">    @quantity = info[:quantity].to_i</code>
        </li>
      
        <li class="covered" data-hits="5546" data-linenumber="19">
          <span class="hits">5546</span>
          
          <code class="ruby">    @unit_price = BigDecimal.new(info[:unit_price], 4)/100</code>
        </li>
      
        <li class="covered" data-hits="5546" data-linenumber="20">
          <span class="hits">5546</span>
          
          <code class="ruby">    @created_at = Time.parse(info[:created_at])</code>
        </li>
      
        <li class="covered" data-hits="5546" data-linenumber="21">
          <span class="hits">5546</span>
          
          <code class="ruby">    @updated_at = Time.parse(info[:updated_at])</code>
        </li>
      
        <li class="covered" data-hits="5546" data-linenumber="22">
          <span class="hits">5546</span>
          
          <code class="ruby">    @invoice_item_repository = invoice_item_repository</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def unit_price_to_dollars</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">    @unit_price.to_f / 100</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoices</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    @invoice_item_repository.find_all_invoices(@invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="682e096b93f71960c3adbdb04b1a53de71f2f0c4">
  <div class="header">
    <h3>lib/invoice_item_repository.rb</h3>
    <h4><span class="green">91.67 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>22</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;csv_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;invoice_item&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class InvoiceItemRepository</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  include CsvParser</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :invoice_items</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(file_name, sales_engine)</code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="9">
          <span class="hits">94</span>
          
          <code class="ruby">    @invoice_items = []</code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="10">
          <span class="hits">94</span>
          
          <code class="ruby">    item_contents = parse_data(file_name)</code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="11">
          <span class="hits">94</span>
          
          <code class="ruby">    item_contents.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="5546" data-linenumber="12">
          <span class="hits">5546</span>
          
          <code class="ruby">      @invoice_items &lt;&lt; InvoiceItem.new(row, self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="14">
          <span class="hits">94</span>
          
          <code class="ruby">    @sales_engine = sales_engine</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  def all</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    @invoice_items</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_id(id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">    @invoice_items.find {|invoice_item| invoice_item.id == id }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_item_id(item_id)</code>
        </li>
      
        <li class="covered" data-hits="60" data-linenumber="26">
          <span class="hits">60</span>
          
          <code class="ruby">    @invoice_items.select {|invoice_item| invoice_item.item_id == item_id }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_invoice_id(invoice_id)</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="30">
          <span class="hits">31</span>
          
          <code class="ruby">    @invoice_items.select {|invoice_item|</code>
        </li>
      
        <li class="covered" data-hits="1829" data-linenumber="31">
          <span class="hits">1829</span>
          
          <code class="ruby">       invoice_item.invoice_id == invoice_id }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_invoices(invoice_id)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    @sales_engine.invoices.find_all_by_id(invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def inspect</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">    &quot;#&lt;#{self.class} #{@merchants.size} rows&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="7daf7565a0e67cc7e5515a1c6defc32799450be9">
  <div class="header">
    <h3>lib/invoice_repository.rb</h3>
    <h4><span class="green">94.12 %</span> covered</h4>
    <div>
      <b>34</b> relevant lines. 
      <span class="green"><b>32</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;csv_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;invoice&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class InvoiceRepository</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  include CsvParser</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :sales_engine</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :invoices</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(file_name, sales_engine)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="11">
          <span class="hits">94</span>
          
          <code class="ruby">    @invoices = []</code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="12">
          <span class="hits">94</span>
          
          <code class="ruby">    contents = parse_data(file_name)</code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="13">
          <span class="hits">94</span>
          
          <code class="ruby">    contents.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="4324" data-linenumber="14">
          <span class="hits">4324</span>
          
          <code class="ruby">        @invoices &lt;&lt; Invoice.new(row, self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="16">
          <span class="hits">94</span>
          
          <code class="ruby">    @sales_engine = sales_engine</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def all</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">    @invoices</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_id(id)</code>
        </li>
      
        <li class="covered" data-hits="123" data-linenumber="24">
          <span class="hits">123</span>
          
          <code class="ruby">    @invoices.find {|invoice| invoice.id == id }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_id(id)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    @invoices.select {|invoice| invoice.id == id }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_customer_id(id)</code>
        </li>
      
        <li class="covered" data-hits="188" data-linenumber="32">
          <span class="hits">188</span>
          
          <code class="ruby">    @invoices.select {|invoice| invoice.customer_id == id }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_merchant_id(id)</code>
        </li>
      
        <li class="covered" data-hits="3243" data-linenumber="36">
          <span class="hits">3243</span>
          
          <code class="ruby">    @invoices.select {|invoice| invoice.merchant_id == id }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_status(status)</code>
        </li>
      
        <li class="covered" data-hits="141" data-linenumber="40">
          <span class="hits">141</span>
          
          <code class="ruby">    @invoices.select {|invoice| invoice.status == status}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_invoice_items_by_invoice_id(id)</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="44">
          <span class="hits">30</span>
          
          <code class="ruby">    @sales_engine.invoice_items.find_all_by_invoice_id(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_item_by_item_id(item_id)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="48">
          <span class="hits">3</span>
          
          <code class="ruby">    @sales_engine.items.find_by_id(item_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_transactions_by_invoice_id(invoice_id)</code>
        </li>
      
        <li class="covered" data-hits="148" data-linenumber="52">
          <span class="hits">148</span>
          
          <code class="ruby">    @sales_engine.transactions.find_all_by_invoice_id(invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_customer_by_id(customer_id)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="56">
          <span class="hits">8</span>
          
          <code class="ruby">    @sales_engine.customers.find_by_id(customer_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def inspect</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">  &quot;#&lt;#{self.class} #{@merchants.size} rows&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="cdd5b2272d9aa7afbd7cf7f48e2f4e341d0e9de1">
  <div class="header">
    <h3>lib/item.rb</h3>
    <h4><span class="green">94.74 %</span> covered</h4>
    <div>
      <b>19</b> relevant lines. 
      <span class="green"><b>18</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;time&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;bigdecimal&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class Item</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">              :description,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">              :unit_price,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">              :created_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">              :updated_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">              :merchant_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">              :id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :merchant</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(info, item_repository)</code>
        </li>
      
        <li class="covered" data-hits="6660" data-linenumber="16">
          <span class="hits">6660</span>
          
          <code class="ruby">    @id = info[:id].to_i</code>
        </li>
      
        <li class="covered" data-hits="6660" data-linenumber="17">
          <span class="hits">6660</span>
          
          <code class="ruby">    @name = info[:name]</code>
        </li>
      
        <li class="covered" data-hits="6660" data-linenumber="18">
          <span class="hits">6660</span>
          
          <code class="ruby">    @description = info[:description]</code>
        </li>
      
        <li class="covered" data-hits="6660" data-linenumber="19">
          <span class="hits">6660</span>
          
          <code class="ruby">    @unit_price = BigDecimal.new(info[:unit_price],4)/100</code>
        </li>
      
        <li class="covered" data-hits="6660" data-linenumber="20">
          <span class="hits">6660</span>
          
          <code class="ruby">    @created_at = Time.parse(info[:created_at])</code>
        </li>
      
        <li class="covered" data-hits="6660" data-linenumber="21">
          <span class="hits">6660</span>
          
          <code class="ruby">    @updated_at = Time.parse(info[:updated_at])</code>
        </li>
      
        <li class="covered" data-hits="6660" data-linenumber="22">
          <span class="hits">6660</span>
          
          <code class="ruby">    @merchant_id = info[:merchant_id].to_i</code>
        </li>
      
        <li class="covered" data-hits="6660" data-linenumber="23">
          <span class="hits">6660</span>
          
          <code class="ruby">    @item_repository = item_repository</code>
        </li>
      
        <li class="covered" data-hits="6660" data-linenumber="24">
          <span class="hits">6660</span>
          
          <code class="ruby">    @merchant = &#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def merchant</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">    @item_repository.find_all_by_merchant_id_in_merchant_repo(@merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoice_items</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    @item_repository.find_all_invoice_items_by_item_id(@id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="bcb176bc07ec6eccd0262755a8d1ff2c748b2567">
  <div class="header">
    <h3>lib/item_repository.rb</h3>
    <h4><span class="green">90.91 %</span> covered</h4>
    <div>
      <b>33</b> relevant lines. 
      <span class="green"><b>30</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;csv_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;item&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;bigdecimal&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">class ItemRepository</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  include CsvParser</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :sales_engine</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :items</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(file_name, sales_engine)</code>
        </li>
      
        <li class="covered" data-hits="111" data-linenumber="11">
          <span class="hits">111</span>
          
          <code class="ruby">    @items = []</code>
        </li>
      
        <li class="covered" data-hits="111" data-linenumber="12">
          <span class="hits">111</span>
          
          <code class="ruby">    item_contents = parse_data(file_name)</code>
        </li>
      
        <li class="covered" data-hits="111" data-linenumber="13">
          <span class="hits">111</span>
          
          <code class="ruby">    item_contents.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="6660" data-linenumber="14">
          <span class="hits">6660</span>
          
          <code class="ruby">      @items &lt;&lt; Item.new(row, self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="111" data-linenumber="16">
          <span class="hits">111</span>
          
          <code class="ruby">      @sales_engine = sales_engine</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def all</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    @items</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_id(id)</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="24">
          <span class="hits">34</span>
          
          <code class="ruby">    @items.find {|item| item.id == id}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_name(name)</code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="28">
          <span class="hits">52</span>
          
          <code class="ruby">    @items.find {|item| item.name == name}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_with_description(description)</code>
        </li>
      
        <li class="covered" data-hits="122" data-linenumber="32">
          <span class="hits">122</span>
          
          <code class="ruby">    @items.select {|item| item.description.downcase == description.downcase}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_price(price)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    @items.select {|item| item.unit_price == price}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_price_in_range(range)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">    @items.select {|item| range.include?(item.unit_price)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="24766" data-linenumber="44">
          <span class="hits">24766</span>
          
          <code class="ruby">    @items.select {|item| item.merchant_id == merchant_id}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_merchant_id_in_merchant_repo(id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">    @sales_engine.merchants.find_by_id(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_invoice_items_by_item_id(item_id)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    @sales_engine.invoice_items.find_all_by_item_id(item_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  def inspect</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">  &quot;#&lt;#{self.class} #{@merchants.size} rows&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="d10b1dc3bea25c54c9fac429310f93871ddc48f6">
  <div class="header">
    <h3>lib/merchant.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>15</b> relevant lines. 
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Merchant</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :id, :name, :sales_engine</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  # attr_accessor :items</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(info, merchant_repository)</code>
        </li>
      
        <li class="covered" data-hits="2334" data-linenumber="6">
          <span class="hits">2334</span>
          
          <code class="ruby">    @id = info[:id].to_i</code>
        </li>
      
        <li class="covered" data-hits="2334" data-linenumber="7">
          <span class="hits">2334</span>
          
          <code class="ruby">    @name = info[:name]</code>
        </li>
      
        <li class="covered" data-hits="2334" data-linenumber="8">
          <span class="hits">2334</span>
          
          <code class="ruby">    @merchant_repository = merchant_repository</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    # @items = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def items</code>
        </li>
      
        <li class="covered" data-hits="406" data-linenumber="13">
          <span class="hits">406</span>
          
          <code class="ruby">    @merchant_repository.find_all_by_merchant_id_in_item_repo(@id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoices</code>
        </li>
      
        <li class="covered" data-hits="67" data-linenumber="17">
          <span class="hits">67</span>
          
          <code class="ruby">    @merchant_repository.find_all_by_merchant_id_in_invoice_repo(@id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  def customers</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    customers = []</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    invoices.each do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="23">
          <span class="hits">6</span>
          
          <code class="ruby">      customers &lt;&lt; @merchant_repository.find_all_customers(invoice.customer_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    customers.compact.uniq</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="62de711d7be3b66ca28271b511d229868323639f">
  <div class="header">
    <h3>lib/merchant_repository.rb</h3>
    <h4><span class="green">96.55 %</span> covered</h4>
    <div>
      <b>29</b> relevant lines. 
      <span class="green"><b>28</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;csv_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;merchant&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class MerchantRepository</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  include CsvParser</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :sales_engine</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :merchants</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(file_name, sales_engine)</code>
        </li>
      
        <li class="covered" data-hits="111" data-linenumber="10">
          <span class="hits">111</span>
          
          <code class="ruby">    @merchants = []</code>
        </li>
      
        <li class="covered" data-hits="111" data-linenumber="11">
          <span class="hits">111</span>
          
          <code class="ruby">    merchant_contents = parse_data(file_name)</code>
        </li>
      
        <li class="covered" data-hits="111" data-linenumber="12">
          <span class="hits">111</span>
          
          <code class="ruby">    merchant_contents.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="2331" data-linenumber="13">
          <span class="hits">2331</span>
          
          <code class="ruby">      @merchants &lt;&lt; Merchant.new(row, self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="111" data-linenumber="15">
          <span class="hits">111</span>
          
          <code class="ruby">    @sales_engine = sales_engine</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def all</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="19">
          <span class="hits">5</span>
          
          <code class="ruby">    @merchants</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_id(id)</code>
        </li>
      
        <li class="covered" data-hits="682" data-linenumber="23">
          <span class="hits">682</span>
          
          <code class="ruby">    @merchants.find {|merchant| merchant.id == id }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_name(name)</code>
        </li>
      
        <li class="covered" data-hits="60" data-linenumber="27">
          <span class="hits">60</span>
          
          <code class="ruby">    @merchants.find { |merchant| merchant.name.downcase == name.downcase }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_name(name)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="31">
          <span class="hits">3</span>
          
          <code class="ruby">    @merchants.select do |merchant|</code>
        </li>
      
        <li class="covered" data-hits="63" data-linenumber="32">
          <span class="hits">63</span>
          
          <code class="ruby">      merchant.name.downcase.include?(name.downcase)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_merchant_id_in_item_repo(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="406" data-linenumber="37">
          <span class="hits">406</span>
          
          <code class="ruby">    @sales_engine.items.find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_merchant_id_in_invoice_repo(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="67" data-linenumber="41">
          <span class="hits">67</span>
          
          <code class="ruby">    @sales_engine.invoices.find_all_by_merchant_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_customers(customer_id)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="45">
          <span class="hits">6</span>
          
          <code class="ruby">    @sales_engine.invoices.find_customer_by_id(customer_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def inspect</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    &quot;#&lt;#{self.class} #{@merchants.size} rows&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="0460387b0aa911a69af3639f0f415f27b8d93d1e">
  <div class="header">
    <h3>lib/sales_analyst.rb</h3>
    <h4><span class="red">71.29 %</span> covered</h4>
    <div>
      <b>101</b> relevant lines. 
      <span class="green"><b>72</b> lines covered</span> and
      <span class="red"><b>29</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;sales_engine&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;standard_deviation&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;time&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;bigdecimal&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">class SalesAnalyst</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">include StandardDeviation</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :se</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(se)</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="11">
          <span class="hits">24</span>
          
          <code class="ruby">    @se = se</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_items_per_merchant</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="15">
          <span class="hits">4</span>
          
          <code class="ruby">    average = se.total_items / se.total_merchants.to_f</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="16">
          <span class="hits">4</span>
          
          <code class="ruby">    average.round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def merchants_with_high_item_count</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="20">
          <span class="hits">3</span>
          
          <code class="ruby">    std_dev = average_items_per_merchant_standard_deviation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="22">
          <span class="hits">3</span>
          
          <code class="ruby">    se.merchants.merchants.select do |merchant|</code>
        </li>
      
        <li class="covered" data-hits="63" data-linenumber="23">
          <span class="hits">63</span>
          
          <code class="ruby">      merchant.items.count &gt;= std_dev*2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_item_price_for_merchant(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="28">
          <span class="hits">44</span>
          
          <code class="ruby">    merchant = se.merchants.find_by_id(merchant_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="30">
          <span class="hits">44</span>
          
          <code class="ruby">    total_item_price = merchant.items.reduce(0) do |total_price, item|</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="31">
          <span class="hits">142</span>
          
          <code class="ruby">      total_price + item.unit_price</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="33">
          <span class="hits">44</span>
          
          <code class="ruby">    return (total_item_price /merchant.items.count).round(2) unless total_item_price == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    return 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_average_price_per_merchant</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">    merchant_price_averages = se.merchants.merchants.map do |merchant|</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="39">
          <span class="hits">42</span>
          
          <code class="ruby">      average_item_price_for_merchant(merchant.id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">    average_average = merchant_price_averages.sum / merchant_price_averages.count</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">    average_average.round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  def golden_items</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="46">
          <span class="hits">2</span>
          
          <code class="ruby">    std_dev = item_standard_deviation</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="47">
          <span class="hits">2</span>
          
          <code class="ruby">    se.items.items.select do |item|</code>
        </li>
      
        <li class="covered" data-hits="120" data-linenumber="48">
          <span class="hits">120</span>
          
          <code class="ruby">      item.unit_price &gt;  std_dev * 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_invoices_per_merchant</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    average = se.total_invoices / se.total_merchants.to_f</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    average.round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_invoices_per_merchant_standard_deviation</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">    average = average_invoices_per_merchant</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">    difference_from_average = se.merchant_invoice_count.map do |invoice_count|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">      invoice_count - average</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">    squared_values = difference_from_average.map {|diff| diff ** 2}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">    sum_of_squares = squared_values.sum</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    Math.sqrt(sum_of_squares / (se.merchant_invoice_count.count - 1)).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">  def top_merchants_by_invoice_count</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">    average = average_invoices_per_merchant</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">    std_dev = average_invoices_per_merchant_standard_deviation</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">    se.merchants.merchants.select do |merchant|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">      merchant.invoices.count &gt; (average + std_dev * 2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">  def bottom_merchants_by_invoice_count</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">    average = average_invoices_per_merchant</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">    std_dev = average_invoices_per_merchant_standard_deviation</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    se.merchants.merchants.select do |merchant|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">      merchant.invoices.count &lt; (average - std_dev * 2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">  def top_days_by_invoice_count</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="87">
          
          
          <code class="ruby">    average = average_invoices_per_day.round(2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">    invoice_count_by_day = number_of_invoices_by_day</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">    std_dev = daily_invoice_standard_deviation.ceil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">    top_days = invoice_count_by_day.select do |day, number|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">      invoice_count_by_day[day] &gt; (average + std_dev)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="96">
          <span class="hits">1</span>
          
          <code class="ruby">  def number_of_invoices_by_day</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="97">
          <span class="hits">3</span>
          
          <code class="ruby">    invoices_for_each_weekday = {&#39;Monday&#39; =&gt; 0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">                                 &#39;Tuesday&#39; =&gt; 0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">                                 &#39;Wednesday&#39; =&gt; 0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">                                 &#39;Thursday&#39; =&gt; 0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">                                 &#39;Friday&#39; =&gt; 0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">                                 &#39;Saturday&#39; =&gt; 0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">                                 &#39;Sunday&#39; =&gt; 0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">                                }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="106">
          <span class="hits">3</span>
          
          <code class="ruby">    se.invoices.invoices.each do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="138" data-linenumber="107">
          <span class="hits">138</span>
          
          <code class="ruby">      invoices_for_each_weekday[invoice.day_of_the_week] += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="109">
          <span class="hits">3</span>
          
          <code class="ruby">    invoices_for_each_weekday</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="112">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_invoices_per_day</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">    se.total_invoices.to_f / 7</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoice_status(status)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">    count = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="118">
          
          
          <code class="ruby">    se.invoices.invoices.each {|invoice| count += 1 if invoice.status == status}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="119">
          
          
          <code class="ruby">    percentage = count / se.total_invoices.to_f * 100</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="120">
          
          
          <code class="ruby">    percentage.round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>
          
          <code class="ruby">  def total_revenue_by_date(date)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>
          
          <code class="ruby">    count = 0.00</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="125">
          <span class="hits">1</span>
          
          <code class="ruby">    se.invoices.invoices.each do |invoice|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="127">
          <span class="hits">46</span>
          
          <code class="ruby">      invoice_date = invoice.created_at.strftime(&#39;%Y-%m-%d&#39;)</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="128">
          <span class="hits">46</span>
          
          <code class="ruby">      if invoice_date == date.strftime(&#39;%Y-%m-%d&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="130">
          <span class="hits">2</span>
          
          <code class="ruby">        invoice.invoice_items.each do |invoice_item|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="131">
          <span class="hits">1</span>
          
          <code class="ruby">          count += invoice_item.unit_price * invoice_item.quantity</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">    count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="138">
          <span class="hits">1</span>
          
          <code class="ruby">  def date_converter_to_string(date)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="139">
          
          
          <code class="ruby">    split_date = date.split(&#39; &#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">    return split_date[0].to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="144">
          <span class="hits">1</span>
          
          <code class="ruby">  def top_revenue_earners(n = 20)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="145">
          <span class="hits">1</span>
          
          <code class="ruby">    sorted_merchants = se.merchants.merchants.sort_by do |merchant|</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="146">
          <span class="hits">21</span>
          
          <code class="ruby">      merchant_revenue(merchant)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="148">
          <span class="hits">1</span>
          
          <code class="ruby">    top_earners = sorted_merchants.reverse[0,n]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="151">
          <span class="hits">1</span>
          
          <code class="ruby">  def merchant_revenue(merchant)</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="152">
          <span class="hits">23</span>
          
          <code class="ruby">    revenue= 0.00</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="153">
          <span class="hits">23</span>
          
          <code class="ruby">    merchant.invoices.each do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="51" data-linenumber="154">
          <span class="hits">51</span>
          
          <code class="ruby">      revenue += invoice.total if invoice.is_paid_in_full?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="156">
          <span class="hits">23</span>
          
          <code class="ruby">    revenue</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="159">
          <span class="hits">1</span>
          
          <code class="ruby">  def merchants_with_pending_invoices</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">    #select the merchant if all of an invoices transactions fail</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="161">
          <span class="hits">2</span>
          
          <code class="ruby">    se.merchants.all.select do |merchant|</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="162">
          <span class="hits">42</span>
          
          <code class="ruby">      merchant.invoices.any? do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="60" data-linenumber="163">
          <span class="hits">60</span>
          
          <code class="ruby">        invoice.transactions.all? do |transaction|</code>
        </li>
      
        <li class="covered" data-hits="40" data-linenumber="164">
          <span class="hits">40</span>
          
          <code class="ruby">          transaction.result == &#39;failed&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">        #invoice.status == :pending || invoice.status == &#39;pending&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="171">
          <span class="hits">1</span>
          
          <code class="ruby">  def merchants_with_only_one_item</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="172">
          <span class="hits">2</span>
          
          <code class="ruby">    se.merchants.all.select do |merchant|</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="173">
          <span class="hits">42</span>
          
          <code class="ruby">      merchant.items.count == 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="177">
          <span class="hits">1</span>
          
          <code class="ruby">  def revenue_by_merchant(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="178">
          <span class="hits">2</span>
          
          <code class="ruby">    merchant = se.merchants.find_by_id(merchant_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="179">
          <span class="hits">2</span>
          
          <code class="ruby">    revenue = merchant_revenue(merchant)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="180">
          <span class="hits">2</span>
          
          <code class="ruby">    BigDecimal.new(revenue, 4)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">  # def merchant_revenue(merchant)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">  #   revenue= 0.00</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">  #   merchant.items.each do |item|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">  #     revenue += item.invoice_items.reduce(0) do |sum, invoice_item|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">  #         sum + invoice_item.unit_price * invoice_item.quantity</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">  #     end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby">  #   end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">  #   revenue</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">  # end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="48800ae1d9a8fa7f94544f741aa82863097794b4">
  <div class="header">
    <h3>lib/sales_engine.rb</h3>
    <h4><span class="green">95.08 %</span> covered</h4>
    <div>
      <b>61</b> relevant lines. 
      <span class="green"><b>58</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;merchant_repository&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;item_repository&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;invoice_repository&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;customer_repository&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;invoice_item_repository&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;transaction_repository&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">class SalesEngine</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :merchant_csv_filepath,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">                :item_csv_filepath,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">                :invoice_csv_filepath,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">                :customer_csv_filepath,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">                :invoice_item_csv_filepath,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">                :transaction_csv_filepath</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.from_csv(info)</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="18">
          <span class="hits">159</span>
          
          <code class="ruby">    se = SalesEngine.new</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="19">
          <span class="hits">159</span>
          
          <code class="ruby">    se.merchant_csv_filepath = info[:merchants]</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="20">
          <span class="hits">159</span>
          
          <code class="ruby">    se.item_csv_filepath = info[:items]</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="21">
          <span class="hits">159</span>
          
          <code class="ruby">    se.invoice_csv_filepath = info[:invoices]</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="22">
          <span class="hits">159</span>
          
          <code class="ruby">    se.customer_csv_filepath = info[:customers]</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="23">
          <span class="hits">159</span>
          
          <code class="ruby">    se.invoice_item_csv_filepath = info[:invoice_items]</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="24">
          <span class="hits">159</span>
          
          <code class="ruby">    se.transaction_csv_filepath = info[:transactions]</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="25">
          <span class="hits">159</span>
          
          <code class="ruby">    se</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="29">
          <span class="hits">159</span>
          
          <code class="ruby">    @merchant_csv_filepath = &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="30">
          <span class="hits">159</span>
          
          <code class="ruby">    @item_csv_filepath = &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="31">
          <span class="hits">159</span>
          
          <code class="ruby">    @invoice_csv_filepath = &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="32">
          <span class="hits">159</span>
          
          <code class="ruby">    @customer_csv_filepath = &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="33">
          <span class="hits">159</span>
          
          <code class="ruby">    @invoice_item_csv_filepath = &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="159" data-linenumber="34">
          <span class="hits">159</span>
          
          <code class="ruby">    @transaction_csv_filepath = &#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def merchants</code>
        </li>
      
        <li class="covered" data-hits="185" data-linenumber="38">
          <span class="hits">185</span>
          
          <code class="ruby">    if @merchant_repository.nil?</code>
        </li>
      
        <li class="covered" data-hits="111" data-linenumber="39">
          <span class="hits">111</span>
          
          <code class="ruby">      @merchant_repository = MerchantRepository.new(@merchant_csv_filepath, self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="74" data-linenumber="41">
          <span class="hits">74</span>
          
          <code class="ruby">      @merchant_repository</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  def items</code>
        </li>
      
        <li class="covered" data-hits="535" data-linenumber="46">
          <span class="hits">535</span>
          
          <code class="ruby">    if @item_repository.nil?</code>
        </li>
      
        <li class="covered" data-hits="111" data-linenumber="47">
          <span class="hits">111</span>
          
          <code class="ruby">      @item_repository = ItemRepository.new(@item_csv_filepath, self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="424" data-linenumber="49">
          <span class="hits">424</span>
          
          <code class="ruby">      @item_repository</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoices</code>
        </li>
      
        <li class="covered" data-hits="173" data-linenumber="54">
          <span class="hits">173</span>
          
          <code class="ruby">    if @invoice_repository.nil?</code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="55">
          <span class="hits">94</span>
          
          <code class="ruby">      @invoice_repository = InvoiceRepository.new(@invoice_csv_filepath, self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="79" data-linenumber="57">
          <span class="hits">79</span>
          
          <code class="ruby">      @invoice_repository</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">  def customers</code>
        </li>
      
        <li class="covered" data-hits="102" data-linenumber="62">
          <span class="hits">102</span>
          
          <code class="ruby">    if @customer_repository.nil?</code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="63">
          <span class="hits">94</span>
          
          <code class="ruby">      @customer_repository = CustomerRepository.new(@customer_csv_filepath, self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="65">
          <span class="hits">8</span>
          
          <code class="ruby">      @customer_repository</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoice_items</code>
        </li>
      
        <li class="covered" data-hits="124" data-linenumber="70">
          <span class="hits">124</span>
          
          <code class="ruby">    if @invoice_items.nil?</code>
        </li>
      
        <li class="covered" data-hits="94" data-linenumber="71">
          <span class="hits">94</span>
          
          <code class="ruby">      @invoice_items = InvoiceItemRepository.new(@invoice_item_csv_filepath, self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="73">
          <span class="hits">30</span>
          
          <code class="ruby">      @invoice_items</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">  def transactions</code>
        </li>
      
        <li class="covered" data-hits="232" data-linenumber="78">
          <span class="hits">232</span>
          
          <code class="ruby">    if @transactions.nil?</code>
        </li>
      
        <li class="covered" data-hits="84" data-linenumber="79">
          <span class="hits">84</span>
          
          <code class="ruby">      @transactions = TransactionRepository.new(@transaction_csv_filepath, self)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="148" data-linenumber="81">
          <span class="hits">148</span>
          
          <code class="ruby">      @transactions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">  def total_merchants</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="86">
          <span class="hits">5</span>
          
          <code class="ruby">    self.merchants.merchants.length</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="89">
          <span class="hits">1</span>
          
          <code class="ruby">  def total_items</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="90">
          <span class="hits">9</span>
          
          <code class="ruby">    self.items.items.length</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_items_per_merchant</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">    total_items / total_merchants.to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">  def merchant_item_count</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="98">
          <span class="hits">10</span>
          
          <code class="ruby">    self.merchants.merchants.map do |merchant|</code>
        </li>
      
        <li class="covered" data-hits="210" data-linenumber="99">
          <span class="hits">210</span>
          
          <code class="ruby">      merchant.items.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="103">
          <span class="hits">1</span>
          
          <code class="ruby">  def total_invoices</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">    self.invoices.invoices.length</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">  def merchant_invoice_count</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">    self.merchants.merchants.map {|merchant| merchant.invoices.count}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="a1a99ffea6a5ab4aa02b88a1d79da61ec67c1c9a">
  <div class="header">
    <h3>lib/standard_deviation.rb</h3>
    <h4><span class="red">58.06 %</span> covered</h4>
    <div>
      <b>31</b> relevant lines. 
      <span class="green"><b>18</b> lines covered</span> and
      <span class="red"><b>13</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module StandardDeviation</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_items_per_merchant_standard_deviation</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="4">
          <span class="hits">3</span>
          
          <code class="ruby">    average = average_items_per_merchant</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="6">
          <span class="hits">3</span>
          
          <code class="ruby">    difference_from_average = se.merchant_item_count.map do |item_count|</code>
        </li>
      
        <li class="covered" data-hits="63" data-linenumber="7">
          <span class="hits">63</span>
          
          <code class="ruby">      item_count - average</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="66" data-linenumber="9">
          <span class="hits">66</span>
          
          <code class="ruby">    squared_values = difference_from_average.map {|diff| diff ** 2}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="11">
          <span class="hits">3</span>
          
          <code class="ruby">    sum_of_squares = squared_values.sum</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="13">
          <span class="hits">3</span>
          
          <code class="ruby">    Math.sqrt(sum_of_squares / (se.merchant_item_count.count - 1)).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def item_standard_deviation</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">    total_item_price = se.items.items.reduce(0) do |total_price, item|</code>
        </li>
      
        <li class="covered" data-hits="120" data-linenumber="18">
          <span class="hits">120</span>
          
          <code class="ruby">      total_price + item.unit_price</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">    average_item_price = total_item_price / se.total_items.to_f</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">    item_price_differences = se.items.items.map do |item|</code>
        </li>
      
        <li class="covered" data-hits="120" data-linenumber="23">
          <span class="hits">120</span>
          
          <code class="ruby">      (item.unit_price - average_item_price) ** 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">    sum_of_squares = item_price_differences.sum</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    Math.sqrt(sum_of_squares / (se.total_items - 1))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def average_invoices_per_merchant_standard_deviation</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    average = average_invoices_per_merchant.round</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    difference_from_average = se.merchant_invoice_count.map do |invoice_count|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">      invoice_count - average</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    squared_values = difference_from_average.map {|diff| diff ** 2}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">    sum_of_squares = squared_values.sum</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    std_dev = Math.sqrt(sum_of_squares / (se.merchant_invoice_count.count - 1))</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def daily_invoice_standard_deviation</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    average = average_invoices_per_day</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">    days = number_of_invoices_by_day</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    #get the invoice count for the day and substract the average from it</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    difference_from_average = days.map do |day, number|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">      days[day] - average</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">    squared_values = difference_from_average.map {|diff| diff ** 2}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    sum_of_squares = squared_values.sum</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    Math.sqrt(sum_of_squares / 7).round(2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="81a6f197880d7cda8d4e903a3a38bdf7757aece4">
  <div class="header">
    <h3>lib/transaction.rb</h3>
    <h4><span class="green">92.86 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;time&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class Transaction</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">              :invoice_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">              :credit_card_number,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">              :result,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">              :credit_card_expiration_date,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">              :created_at,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">              :updated_at</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(info, transaction_repo)</code>
        </li>
      
        <li class="covered" data-hits="2520" data-linenumber="13">
          <span class="hits">2520</span>
          
          <code class="ruby">    @id = info[:id].to_i</code>
        </li>
      
        <li class="covered" data-hits="2520" data-linenumber="14">
          <span class="hits">2520</span>
          
          <code class="ruby">    @invoice_id = info[:invoice_id].to_i</code>
        </li>
      
        <li class="covered" data-hits="2520" data-linenumber="15">
          <span class="hits">2520</span>
          
          <code class="ruby">    @credit_card_number = info[:credit_card_number].to_i</code>
        </li>
      
        <li class="covered" data-hits="2520" data-linenumber="16">
          <span class="hits">2520</span>
          
          <code class="ruby">    @credit_card_expiration_date = info[:credit_card_expiration_date]</code>
        </li>
      
        <li class="covered" data-hits="2520" data-linenumber="17">
          <span class="hits">2520</span>
          
          <code class="ruby">    @result = info[:result]</code>
        </li>
      
        <li class="covered" data-hits="2520" data-linenumber="18">
          <span class="hits">2520</span>
          
          <code class="ruby">    @created_at = Time.parse(info[:created_at])</code>
        </li>
      
        <li class="covered" data-hits="2520" data-linenumber="19">
          <span class="hits">2520</span>
          
          <code class="ruby">    @updated_at = Time.parse(info[:updated_at])</code>
        </li>
      
        <li class="covered" data-hits="2520" data-linenumber="20">
          <span class="hits">2520</span>
          
          <code class="ruby">    @transaction_repo = transaction_repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def invoice</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    @transaction_repo.find_all_invoices_by_invoice_id(@invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="c0923319536369ccb0e1948014f6d2aca0887619">
  <div class="header">
    <h3>lib/transaction_repository.rb</h3>
    <h4><span class="red">75.0 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>18</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;csv_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require_relative &#39;transaction&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class TransactionRepository</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  include CsvParser</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :transactions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize(file_name, sales_engine)</code>
        </li>
      
        <li class="covered" data-hits="84" data-linenumber="9">
          <span class="hits">84</span>
          
          <code class="ruby">    @transactions = []</code>
        </li>
      
        <li class="covered" data-hits="84" data-linenumber="10">
          <span class="hits">84</span>
          
          <code class="ruby">    item_contents = parse_data(file_name)</code>
        </li>
      
        <li class="covered" data-hits="2604" data-linenumber="11">
          <span class="hits">2604</span>
          
          <code class="ruby">    item_contents.each {|row| @transactions &lt;&lt; Transaction.new(row,self)}</code>
        </li>
      
        <li class="covered" data-hits="84" data-linenumber="12">
          <span class="hits">84</span>
          
          <code class="ruby">    @sales_engine = sales_engine</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def all</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    @transactions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_by_id(id)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">      @transactions.find {|transaction| transaction.id == id}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_invoice_id(invoice_id)</code>
        </li>
      
        <li class="covered" data-hits="4588" data-linenumber="24">
          <span class="hits">4588</span>
          
          <code class="ruby">    @transactions.select {|transaction| transaction.invoice_id == invoice_id}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_credit_card_number(credit_card_number)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    @transactions.select {|transaction| transaction.credit_card_number == credit_card_number}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_by_result(result)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    @transactions.select {|transaction| transaction.result == result}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_all_invoices_by_invoice_id(invoice_id)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    @sales_engine.invoices.find_by_id(invoice_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def inspect</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">    &quot;#&lt;#{self.class} #{@merchants.size} rows&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>

      
      </div>
    </div>
  </body>
</html>
